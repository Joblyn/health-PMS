{"ast":null,"code":"import _defineProperty from \"/home/joblyn/Desktop/health.workcradle/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _objectSpread from \"/home/joblyn/Desktop/health.workcradle/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _slicedToArray from \"/home/joblyn/Desktop/health.workcradle/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/home/joblyn/Desktop/health.workcradle/src/pages/superadmin/Profile.js\";\nimport React, { useState, useEffect } from \"react\";\nimport { useSelector } from \"react-redux\";\nimport { useDispatch } from \"react-redux\";\nimport { Container, Row, Card, CardHeader, CardBody, Col, Button, Alert } from \"shards-react\";\nimport { FormInput } from \"shards-react\";\nimport PageSpinner from \"../../components/common/PageSpinner\";\nimport PageTitle from \"../../components/common/PageTitle\";\nimport { getAdmins, updateCompanyDataEndpoint } from \"../../apiConstants/apiConstants\";\nimport { updateCompanyData, getAllAdmins } from \"../../actions/superadmin/authAction\";\nexport default function SuperAdminProfile() {\n  var dispatch = useDispatch();\n  var profile = JSON.parse(localStorage.getItem(\"loggedInUser\"));\n\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      edit = _useState2[0],\n      setEdit = _useState2[1];\n\n  var _useState3 = useState(false),\n      _useState4 = _slicedToArray(_useState3, 2),\n      updated = _useState4[0],\n      setUpdated = _useState4[1];\n\n  var allAdmins = useSelector(function (state) {\n    return state.allAdmins;\n  });\n  var updatedCompanyData = useSelector(function (state) {\n    return state.updatedCompanyData;\n  });\n\n  var _useState5 = useState(),\n      _useState6 = _slicedToArray(_useState5, 2),\n      control = _useState6[0],\n      setControl = _useState6[1];\n\n  var _useState7 = useState(false),\n      _useState8 = _slicedToArray(_useState7, 2),\n      customAlert = _useState8[0],\n      setCustomAlert = _useState8[1];\n\n  var _useState9 = useState(false),\n      _useState10 = _slicedToArray(_useState9, 2),\n      emailChanged = _useState10[0],\n      setEmailChanged = _useState10[1];\n\n  var handleChange = function handleChange(_ref) {\n    var target = _ref.target;\n    setControl(_objectSpread({}, control, _defineProperty({}, target.name, target.value)));\n  };\n\n  useEffect(function () {\n    if (allAdmins.isSuccessful && allAdmins.data) {\n      var currentAdmin = allAdmins.data.filter(function (admin) {\n        return admin.id === profile.id;\n      })[0];\n      setControl(currentAdmin);\n    }\n  }, [allAdmins]);\n  useEffect(function () {\n    var endpoint = getAdmins + profile.companyCode;\n    dispatch(getAllAdmins(endpoint));\n  }, []);\n\n  var submitChanges = function submitChanges() {\n    var endpoint = updateCompanyDataEndpoint + control.id;\n    delete control.createdAt;\n    delete control.updatedAt;\n    delete control.id;\n    delete control.isSuperAdmin;\n    console.log(control);\n\n    if (control.email !== profile.email) {\n      setEmailChanged(true);\n      setUpdated(true);\n      dispatch(updateCompanyData(endpoint, control));\n    } else {\n      dispatch(updateCompanyData(endpoint, control));\n      setUpdated(true);\n      setEmailChanged(false);\n    }\n  };\n\n  useEffect(function () {\n    console.log(updated);\n    console.log(updatedCompanyData);\n\n    if (updated && updatedCompanyData.isSuccessful) {\n      console.log(emailChanged);\n\n      if (emailChanged) {\n        alert(\"Changed email. Kindly login with new email\");\n        setCustomAlert(false);\n        window.localStorage.clear();\n        window.location.pathname = \"/interface\";\n      } else {\n        setCustomAlert(true);\n      }\n    }\n  }, [updatedCompanyData, updated, emailChanged]);\n  useEffect(function () {\n    if (customAlert) {\n      setTimeout(function () {\n        setCustomAlert(false);\n        window.location.reload();\n      }, 2000);\n    }\n  }, [customAlert]);\n\n  var restore = function restore() {\n    setControl(profile);\n  };\n\n  if (!control) {\n    return /*#__PURE__*/React.createElement(PageSpinner, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 102,\n        columnNumber: 12\n      }\n    });\n  }\n\n  return /*#__PURE__*/React.createElement(Container, {\n    style: {\n      minHeight: \"100vh\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 5\n    }\n  }, customAlert && /*#__PURE__*/React.createElement(Container, {\n    fluid: true,\n    className: \"px-0 sticky-top\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Alert, {\n    className: \"mb-0 text-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"i\", {\n    className: \"fa fa-info mx-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 13\n    }\n  }), \"Editted Company Profile.\")), /*#__PURE__*/React.createElement(Row, {\n    noGutters: true,\n    className: \"page-header py-4\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(PageTitle, {\n    sm: \"4\",\n    title: \"Profile\",\n    subtitle: \"Dashboard\",\n    className: \"text-sm-left\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 9\n    }\n  })), /*#__PURE__*/React.createElement(Card, {\n    style: {\n      width: \"100%\",\n      maxWidth: \"506px\"\n    },\n    className: \"mx-auto\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(CardHeader, {\n    className: \"border-bottom\",\n    style: {\n      fontSize: \"1.2rem\",\n      fontWeight: \"bold\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 9\n    }\n  }, \"Company Profile\"), /*#__PURE__*/React.createElement(CardBody, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Col, {\n    className: \"d-flex flex-row align-items-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"h6\", {\n    className: \"mb-0 mr-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 13\n    }\n  }, \"Name:\"), /*#__PURE__*/React.createElement(FormInput, {\n    defaultValue: \"\".concat(control.name),\n    disabled: !edit,\n    name: \"name\",\n    style: !edit ? {\n      background: \"transparent\",\n      border: \"none\",\n      fontSize: \"1rem\"\n    } : {\n      fontSize: \"1rem\"\n    },\n    onChange: handleChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(Col, {\n    className: \"d-flex flex-row align-items-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"h6\", {\n    className: \"mb-0 mr-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150,\n      columnNumber: 13\n    }\n  }, \"Email:\"), /*#__PURE__*/React.createElement(FormInput, {\n    defaultValue: \"\".concat(control.email),\n    disabled: !edit,\n    name: \"email\",\n    type: \"email\",\n    style: !edit ? {\n      background: \"transparent\",\n      border: \"none\",\n      fontSize: \"1rem\"\n    } : {\n      fontSize: \"1rem\"\n    },\n    onChange: handleChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(Col, {\n    className: \"d-flex flex-row align-items-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 168,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"h6\", {\n    className: \"mb-0 mr-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169,\n      columnNumber: 13\n    }\n  }, \"Phone:\"), /*#__PURE__*/React.createElement(FormInput, {\n    defaultValue: \"\".concat(control.phone),\n    disabled: !edit,\n    name: \"phone\",\n    type: \"email\",\n    style: !edit ? {\n      background: \"transparent\",\n      border: \"none\",\n      fontSize: \"1rem\"\n    } : {\n      fontSize: \"1rem\"\n    },\n    onChange: handleChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 170,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(Col, {\n    className: \"d-flex flex-row align-items-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"h6\", {\n    className: \"mb-0 mr-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 188,\n      columnNumber: 13\n    }\n  }, \"Role:\"), /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 189,\n      columnNumber: 13\n    }\n  }, \"Admin\")), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"d-flex flew-row mt-5\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 192,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    size: \"sm\",\n    theme: \"primary\",\n    className: \"ml-3\",\n    onClick: edit ? submitChanges : function () {\n      return setEdit(true);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 193,\n      columnNumber: 13\n    }\n  }, edit ? \"Submit Changes\" : \"Update Profile\"), edit && /*#__PURE__*/React.createElement(Button, {\n    size: \"sm\",\n    theme: \"danger\",\n    className: \"ml-3\",\n    onClick: function onClick() {\n      restore();\n      setEdit(false);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 202,\n      columnNumber: 15\n    }\n  }, \"Cancel Changes\")))));\n}","map":{"version":3,"sources":["/home/joblyn/Desktop/health.workcradle/src/pages/superadmin/Profile.js"],"names":["React","useState","useEffect","useSelector","useDispatch","Container","Row","Card","CardHeader","CardBody","Col","Button","Alert","FormInput","PageSpinner","PageTitle","getAdmins","updateCompanyDataEndpoint","updateCompanyData","getAllAdmins","SuperAdminProfile","dispatch","profile","JSON","parse","localStorage","getItem","edit","setEdit","updated","setUpdated","allAdmins","state","updatedCompanyData","control","setControl","customAlert","setCustomAlert","emailChanged","setEmailChanged","handleChange","target","name","value","isSuccessful","data","currentAdmin","filter","admin","id","endpoint","companyCode","submitChanges","createdAt","updatedAt","isSuperAdmin","console","log","email","alert","window","clear","location","pathname","setTimeout","reload","restore","minHeight","width","maxWidth","fontSize","fontWeight","background","border","phone"],"mappings":";;;;AAAA,OAAOA,KAAP,IAAgBC,QAAhB,EAA0BC,SAA1B,QAA2C,OAA3C;AACA,SAASC,WAAT,QAA4B,aAA5B;AACA,SAASC,WAAT,QAA4B,aAA5B;AACA,SACEC,SADF,EAEEC,GAFF,EAGEC,IAHF,EAIEC,UAJF,EAKEC,QALF,EAMEC,GANF,EAOEC,MAPF,EAQEC,KARF,QASO,cATP;AAUA,SAASC,SAAT,QAA0B,cAA1B;AACA,OAAOC,WAAP,MAAwB,qCAAxB;AACA,OAAOC,SAAP,MAAsB,mCAAtB;AACA,SACEC,SADF,EAEEC,yBAFF,QAGO,iCAHP;AAIA,SACEC,iBADF,EAEEC,YAFF,QAGO,qCAHP;AAKA,eAAe,SAASC,iBAAT,GAA6B;AAC1C,MAAMC,QAAQ,GAAGjB,WAAW,EAA5B;AACA,MAAMkB,OAAO,GAAGC,IAAI,CAACC,KAAL,CAAWC,YAAY,CAACC,OAAb,CAAqB,cAArB,CAAX,CAAhB;;AAF0C,kBAIlBzB,QAAQ,CAAC,KAAD,CAJU;AAAA;AAAA,MAInC0B,IAJmC;AAAA,MAI7BC,OAJ6B;;AAAA,mBAKZ3B,QAAQ,CAAC,KAAD,CALI;AAAA;AAAA,MAKnC4B,OALmC;AAAA,MAK1BC,UAL0B;;AAM1C,MAAMC,SAAS,GAAG5B,WAAW,CAAC,UAAC6B,KAAD;AAAA,WAAWA,KAAK,CAACD,SAAjB;AAAA,GAAD,CAA7B;AACA,MAAME,kBAAkB,GAAG9B,WAAW,CAAC,UAAC6B,KAAD;AAAA,WAAWA,KAAK,CAACC,kBAAjB;AAAA,GAAD,CAAtC;;AAP0C,mBASZhC,QAAQ,EATI;AAAA;AAAA,MASnCiC,OATmC;AAAA,MAS1BC,UAT0B;;AAAA,mBAUJlC,QAAQ,CAAC,KAAD,CAVJ;AAAA;AAAA,MAUnCmC,WAVmC;AAAA,MAUtBC,cAVsB;;AAAA,mBAWFpC,QAAQ,CAAC,KAAD,CAXN;AAAA;AAAA,MAWnCqC,YAXmC;AAAA,MAWrBC,eAXqB;;AAY1C,MAAMC,YAAY,GAAG,SAAfA,YAAe,OAAgB;AAAA,QAAbC,MAAa,QAAbA,MAAa;AACnCN,IAAAA,UAAU,mBAAMD,OAAN,sBAAgBO,MAAM,CAACC,IAAvB,EAA8BD,MAAM,CAACE,KAArC,GAAV;AACD,GAFD;;AAIAzC,EAAAA,SAAS,CAAC,YAAM;AACd,QAAI6B,SAAS,CAACa,YAAV,IAA0Bb,SAAS,CAACc,IAAxC,EAA8C;AAC5C,UAAIC,YAAY,GAAGf,SAAS,CAACc,IAAV,CAAeE,MAAf,CAAsB,UAAAC,KAAK;AAAA,eAAEA,KAAK,CAACC,EAAN,KAAW3B,OAAO,CAAC2B,EAArB;AAAA,OAA3B,EAAoD,CAApD,CAAnB;AACAd,MAAAA,UAAU,CAACW,YAAD,CAAV;AACD;AACF,GALQ,EAKN,CAACf,SAAD,CALM,CAAT;AAOA7B,EAAAA,SAAS,CAAC,YAAM;AACd,QAAMgD,QAAQ,GAAGlC,SAAS,GAAGM,OAAO,CAAC6B,WAArC;AACA9B,IAAAA,QAAQ,CAACF,YAAY,CAAC+B,QAAD,CAAb,CAAR;AACD,GAHQ,EAGN,EAHM,CAAT;;AAKA,MAAME,aAAa,GAAG,SAAhBA,aAAgB,GAAM;AAC1B,QAAIF,QAAQ,GAAGjC,yBAAyB,GAAGiB,OAAO,CAACe,EAAnD;AACA,WAAOf,OAAO,CAACmB,SAAf;AACA,WAAOnB,OAAO,CAACoB,SAAf;AACA,WAAOpB,OAAO,CAACe,EAAf;AACA,WAAOf,OAAO,CAACqB,YAAf;AACAC,IAAAA,OAAO,CAACC,GAAR,CAAYvB,OAAZ;;AACA,QAAIA,OAAO,CAACwB,KAAR,KAAkBpC,OAAO,CAACoC,KAA9B,EAAqC;AACnCnB,MAAAA,eAAe,CAAC,IAAD,CAAf;AACAT,MAAAA,UAAU,CAAC,IAAD,CAAV;AACAT,MAAAA,QAAQ,CAACH,iBAAiB,CAACgC,QAAD,EAAWhB,OAAX,CAAlB,CAAR;AACD,KAJD,MAIO;AACLb,MAAAA,QAAQ,CAACH,iBAAiB,CAACgC,QAAD,EAAWhB,OAAX,CAAlB,CAAR;AACAJ,MAAAA,UAAU,CAAC,IAAD,CAAV;AACAS,MAAAA,eAAe,CAAC,KAAD,CAAf;AACD;AACF,GAhBD;;AAkBArC,EAAAA,SAAS,CAAC,YAAM;AACdsD,IAAAA,OAAO,CAACC,GAAR,CAAY5B,OAAZ;AACA2B,IAAAA,OAAO,CAACC,GAAR,CAAYxB,kBAAZ;;AACA,QAAIJ,OAAO,IAAII,kBAAkB,CAACW,YAAlC,EAAgD;AAC9CY,MAAAA,OAAO,CAACC,GAAR,CAAYnB,YAAZ;;AACA,UAAIA,YAAJ,EAAkB;AAChBqB,QAAAA,KAAK,CAAC,4CAAD,CAAL;AACAtB,QAAAA,cAAc,CAAC,KAAD,CAAd;AACAuB,QAAAA,MAAM,CAACnC,YAAP,CAAoBoC,KAApB;AACAD,QAAAA,MAAM,CAACE,QAAP,CAAgBC,QAAhB,GAA2B,YAA3B;AACD,OALD,MAKO;AACL1B,QAAAA,cAAc,CAAC,IAAD,CAAd;AACD;AACF;AACF,GAdQ,EAcN,CAACJ,kBAAD,EAAqBJ,OAArB,EAA8BS,YAA9B,CAdM,CAAT;AAgBApC,EAAAA,SAAS,CAAC,YAAM;AACd,QAAIkC,WAAJ,EAAiB;AACf4B,MAAAA,UAAU,CAAC,YAAM;AACf3B,QAAAA,cAAc,CAAC,KAAD,CAAd;AACAuB,QAAAA,MAAM,CAACE,QAAP,CAAgBG,MAAhB;AACD,OAHS,EAGP,IAHO,CAAV;AAID;AACF,GAPQ,EAON,CAAC7B,WAAD,CAPM,CAAT;;AASA,MAAM8B,OAAO,GAAG,SAAVA,OAAU,GAAM;AACpB/B,IAAAA,UAAU,CAACb,OAAD,CAAV;AACD,GAFD;;AAIA,MAAI,CAACY,OAAL,EAAc;AACZ,wBAAO,oBAAC,WAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAAP;AACD;;AAED,sBACE,oBAAC,SAAD;AAAW,IAAA,KAAK,EAAE;AAAEiC,MAAAA,SAAS,EAAE;AAAb,KAAlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACG/B,WAAW,iBACV,oBAAC,SAAD;AAAW,IAAA,KAAK,MAAhB;AAAiB,IAAA,SAAS,EAAC,iBAA3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,KAAD;AAAO,IAAA,SAAS,EAAC,kBAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AAAG,IAAA,SAAS,EAAC,iBAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,6BADF,CAFJ,eAQE,oBAAC,GAAD;AAAK,IAAA,SAAS,MAAd;AAAe,IAAA,SAAS,EAAC,kBAAzB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,SAAD;AACE,IAAA,EAAE,EAAC,GADL;AAEE,IAAA,KAAK,EAAC,SAFR;AAGE,IAAA,QAAQ,EAAC,WAHX;AAIE,IAAA,SAAS,EAAC,cAJZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,CARF,eAiBE,oBAAC,IAAD;AAAM,IAAA,KAAK,EAAE;AAAEgC,MAAAA,KAAK,EAAE,MAAT;AAAiBC,MAAAA,QAAQ,EAAE;AAA3B,KAAb;AAAmD,IAAA,SAAS,EAAC,SAA7D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,UAAD;AACE,IAAA,SAAS,EAAC,eADZ;AAEE,IAAA,KAAK,EAAE;AAAEC,MAAAA,QAAQ,EAAE,QAAZ;AAAsBC,MAAAA,UAAU,EAAE;AAAlC,KAFT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBADF,eAOE,oBAAC,QAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,GAAD;AAAK,IAAA,SAAS,EAAC,oCAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AAAI,IAAA,SAAS,EAAC,WAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aADF,eAEE,oBAAC,SAAD;AACE,IAAA,YAAY,YAAKrC,OAAO,CAACQ,IAAb,CADd;AAEE,IAAA,QAAQ,EAAE,CAACf,IAFb;AAGE,IAAA,IAAI,EAAC,MAHP;AAIE,IAAA,KAAK,EACH,CAACA,IAAD,GACI;AACE6C,MAAAA,UAAU,EAAE,aADd;AAEEC,MAAAA,MAAM,EAAE,MAFV;AAGEH,MAAAA,QAAQ,EAAE;AAHZ,KADJ,GAMI;AAAEA,MAAAA,QAAQ,EAAE;AAAZ,KAXR;AAaE,IAAA,QAAQ,EAAE9B,YAbZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAFF,CADF,eAmBE,oBAAC,GAAD;AAAK,IAAA,SAAS,EAAC,oCAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AAAI,IAAA,SAAS,EAAC,WAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cADF,eAEE,oBAAC,SAAD;AACE,IAAA,YAAY,YAAKN,OAAO,CAACwB,KAAb,CADd;AAEE,IAAA,QAAQ,EAAE,CAAC/B,IAFb;AAGE,IAAA,IAAI,EAAC,OAHP;AAIE,IAAA,IAAI,EAAC,OAJP;AAKE,IAAA,KAAK,EACH,CAACA,IAAD,GACI;AACE6C,MAAAA,UAAU,EAAE,aADd;AAEEC,MAAAA,MAAM,EAAE,MAFV;AAGEH,MAAAA,QAAQ,EAAE;AAHZ,KADJ,GAMI;AAAEA,MAAAA,QAAQ,EAAE;AAAZ,KAZR;AAcE,IAAA,QAAQ,EAAE9B,YAdZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAFF,CAnBF,eAsCE,oBAAC,GAAD;AAAK,IAAA,SAAS,EAAC,oCAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AAAI,IAAA,SAAS,EAAC,WAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cADF,eAEE,oBAAC,SAAD;AACE,IAAA,YAAY,YAAKN,OAAO,CAACwC,KAAb,CADd;AAEE,IAAA,QAAQ,EAAE,CAAC/C,IAFb;AAGE,IAAA,IAAI,EAAC,OAHP;AAIE,IAAA,IAAI,EAAC,OAJP;AAKE,IAAA,KAAK,EACH,CAACA,IAAD,GACI;AACE6C,MAAAA,UAAU,EAAE,aADd;AAEEC,MAAAA,MAAM,EAAE,MAFV;AAGEH,MAAAA,QAAQ,EAAE;AAHZ,KADJ,GAMI;AAAEA,MAAAA,QAAQ,EAAE;AAAZ,KAZR;AAcE,IAAA,QAAQ,EAAE9B,YAdZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAFF,CAtCF,eAyDE,oBAAC,GAAD;AAAK,IAAA,SAAS,EAAC,oCAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AAAI,IAAA,SAAS,EAAC,WAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aADF,eAEE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aAFF,CAzDF,eA8DE;AAAK,IAAA,SAAS,EAAC,sBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,MAAD;AACE,IAAA,IAAI,EAAC,IADP;AAEE,IAAA,KAAK,EAAC,SAFR;AAGE,IAAA,SAAS,EAAC,MAHZ;AAIE,IAAA,OAAO,EAAEb,IAAI,GAAGyB,aAAH,GAAmB;AAAA,aAAMxB,OAAO,CAAC,IAAD,CAAb;AAAA,KAJlC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAMGD,IAAI,GAAG,gBAAH,GAAsB,gBAN7B,CADF,EASGA,IAAI,iBACH,oBAAC,MAAD;AACE,IAAA,IAAI,EAAC,IADP;AAEE,IAAA,KAAK,EAAC,QAFR;AAGE,IAAA,SAAS,EAAC,MAHZ;AAIE,IAAA,OAAO,EAAE,mBAAM;AACbuC,MAAAA,OAAO;AACPtC,MAAAA,OAAO,CAAC,KAAD,CAAP;AACD,KAPH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBAVJ,CA9DF,CAPF,CAjBF,CADF;AAkHD","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { useSelector } from \"react-redux\";\nimport { useDispatch } from \"react-redux\";\nimport {\n  Container,\n  Row,\n  Card,\n  CardHeader,\n  CardBody,\n  Col,\n  Button,\n  Alert,\n} from \"shards-react\";\nimport { FormInput } from \"shards-react\";\nimport PageSpinner from \"../../components/common/PageSpinner\";\nimport PageTitle from \"../../components/common/PageTitle\";\nimport {\n  getAdmins,\n  updateCompanyDataEndpoint,\n} from \"../../apiConstants/apiConstants\";\nimport {\n  updateCompanyData,\n  getAllAdmins,\n} from \"../../actions/superadmin/authAction\";\n\nexport default function SuperAdminProfile() {\n  const dispatch = useDispatch();\n  const profile = JSON.parse(localStorage.getItem(\"loggedInUser\"));\n\n  const [edit, setEdit] = useState(false);\n  const [updated, setUpdated] = useState(false);\n  const allAdmins = useSelector((state) => state.allAdmins);\n  const updatedCompanyData = useSelector((state) => state.updatedCompanyData);\n\n  const [control, setControl] = useState();\n  const [customAlert, setCustomAlert] = useState(false);\n  const [emailChanged, setEmailChanged] = useState(false);\n  const handleChange = ({ target }) => {\n    setControl({ ...control, [target.name]: target.value });\n  };\n\n  useEffect(() => {\n    if (allAdmins.isSuccessful && allAdmins.data) {\n      let currentAdmin = allAdmins.data.filter(admin=>admin.id===profile.id)[0];\n      setControl(currentAdmin);\n    }\n  }, [allAdmins]);\n\n  useEffect(() => {\n    const endpoint = getAdmins + profile.companyCode;\n    dispatch(getAllAdmins(endpoint));\n  }, []);\n\n  const submitChanges = () => {\n    let endpoint = updateCompanyDataEndpoint + control.id;\n    delete control.createdAt;\n    delete control.updatedAt;\n    delete control.id;\n    delete control.isSuperAdmin;\n    console.log(control);\n    if (control.email !== profile.email) {\n      setEmailChanged(true);\n      setUpdated(true);\n      dispatch(updateCompanyData(endpoint, control));\n    } else {\n      dispatch(updateCompanyData(endpoint, control));\n      setUpdated(true);\n      setEmailChanged(false);\n    }\n  };\n\n  useEffect(() => {\n    console.log(updated);\n    console.log(updatedCompanyData);\n    if (updated && updatedCompanyData.isSuccessful) {\n      console.log(emailChanged);\n      if (emailChanged) {\n        alert(\"Changed email. Kindly login with new email\");\n        setCustomAlert(false);\n        window.localStorage.clear();\n        window.location.pathname = \"/interface\";\n      } else {\n        setCustomAlert(true);\n      }\n    }\n  }, [updatedCompanyData, updated, emailChanged]);\n\n  useEffect(() => {\n    if (customAlert) {\n      setTimeout(() => {\n        setCustomAlert(false);\n        window.location.reload();\n      }, 2000);\n    }\n  }, [customAlert]);\n\n  const restore = () => {\n    setControl(profile);\n  };\n\n  if (!control) {\n    return <PageSpinner />;\n  }\n\n  return (\n    <Container style={{ minHeight: \"100vh\" }}>\n      {customAlert && (\n        <Container fluid className=\"px-0 sticky-top\">\n          <Alert className=\"mb-0 text-center\">\n            <i className=\"fa fa-info mx-2\"></i>Editted Company Profile.\n          </Alert>\n        </Container>\n      )}\n      <Row noGutters className=\"page-header py-4\">\n        <PageTitle\n          sm=\"4\"\n          title=\"Profile\"\n          subtitle=\"Dashboard\"\n          className=\"text-sm-left\"\n        />\n      </Row>\n\n      <Card style={{ width: \"100%\", maxWidth: \"506px\" }} className=\"mx-auto\">\n        <CardHeader\n          className=\"border-bottom\"\n          style={{ fontSize: \"1.2rem\", fontWeight: \"bold\" }}\n        >\n          Company Profile\n        </CardHeader>\n        <CardBody>\n          <Col className=\"d-flex flex-row align-items-center\">\n            <h6 className=\"mb-0 mr-2\">Name:</h6>\n            <FormInput\n              defaultValue={`${control.name}`}\n              disabled={!edit}\n              name=\"name\"\n              style={\n                !edit\n                  ? {\n                      background: \"transparent\",\n                      border: \"none\",\n                      fontSize: \"1rem\",\n                    }\n                  : { fontSize: \"1rem\" }\n              }\n              onChange={handleChange}\n            />\n          </Col>\n          <Col className=\"d-flex flex-row align-items-center\">\n            <h6 className=\"mb-0 mr-2\">Email:</h6>\n            <FormInput\n              defaultValue={`${control.email}`}\n              disabled={!edit}\n              name=\"email\"\n              type=\"email\"\n              style={\n                !edit\n                  ? {\n                      background: \"transparent\",\n                      border: \"none\",\n                      fontSize: \"1rem\",\n                    }\n                  : { fontSize: \"1rem\" }\n              }\n              onChange={handleChange}\n            />\n          </Col>\n          <Col className=\"d-flex flex-row align-items-center\">\n            <h6 className=\"mb-0 mr-2\">Phone:</h6>\n            <FormInput\n              defaultValue={`${control.phone}`}\n              disabled={!edit}\n              name=\"phone\"\n              type=\"email\"\n              style={\n                !edit\n                  ? {\n                      background: \"transparent\",\n                      border: \"none\",\n                      fontSize: \"1rem\",\n                    }\n                  : { fontSize: \"1rem\" }\n              }\n              onChange={handleChange}\n            />\n          </Col>\n          <Col className=\"d-flex flex-row align-items-center\">\n            <h6 className=\"mb-0 mr-2\">Role:</h6>\n            <span>Admin</span>\n          </Col>\n\n          <div className=\"d-flex flew-row mt-5\">\n            <Button\n              size=\"sm\"\n              theme=\"primary\"\n              className=\"ml-3\"\n              onClick={edit ? submitChanges : () => setEdit(true)}\n            >\n              {edit ? \"Submit Changes\" : \"Update Profile\"}\n            </Button>\n            {edit && (\n              <Button\n                size=\"sm\"\n                theme=\"danger\"\n                className=\"ml-3\"\n                onClick={() => {\n                  restore();\n                  setEdit(false);\n                }}\n              >\n                Cancel Changes\n              </Button>\n            )}\n          </div>\n        </CardBody>\n      </Card>\n    </Container>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}